<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Physics Sandbox</title>

<style>
body {
  margin:0;
  overflow:hidden;
  font-family:Arial, sans-serif;
  background:#0a0a0a;
  cursor:none;
}

/* THEMES */
body.theme-dark { background:#0a0a0a; }
body.theme-grid { background:#0e0e16; }
body.theme-sand { background:#1a1408; }
body.theme-lab  { background:#0f1a1f; }

canvas { display:block; }

#toolbar {
  position:fixed;
  top:0;
  left:0;
  right:0;
  height:70px;
  background:rgba(20,20,20,.95);
  display:flex;
  gap:8px;
  padding:10px;
  overflow-x:auto;
  border-bottom:1px solid #333;
}

.tool {
  min-width:90px;
  padding:8px;
  background:#1e1e1e;
  color:#fff;
  border:1px solid #333;
  text-align:center;
  cursor:pointer;
  user-select:none;
}

.tool.active { background:#4fc3f7; color:#000; }
#clear { background:#b71c1c; }

#settingsBtn {
  background:#6a1b9a;
}

/* SETTINGS PANEL */
#settings {
  position:fixed;
  top:80px;
  right:10px;
  width:260px;
  background:#111;
  border:1px solid #333;
  padding:10px;
  display:none;
  color:#fff;
  font-size:14px;
}

#settings h3 {
  margin:6px 0;
  font-size:14px;
}

.setting {
  margin-bottom:8px;
}

.setting select,
.setting input {
  width:100%;
}

.cursor-preview {
  display:inline-block;
  width:24px;
  height:24px;
  border:1px solid #444;
  margin-right:6px;
  vertical-align:middle;
}

/* CURSOR */
#cursor {
  position:fixed;
  pointer-events:none;
}

.cursor-cross {
  width:14px;height:14px;
}
.cursor-cross::before {
  content:"";
  position:absolute;
  inset:0;
  background:
    linear-gradient(#fff 0 0),
    linear-gradient(#fff 0 0);
  background-size:100% 2px,2px 100%;
  background-position:center;
  background-repeat:no-repeat;
}

.cursor-square {
  width:10px;height:10px;
  background:#fff;
}

.cursor-dot {
  width:6px;height:6px;
  background:#fff;
  border-radius:50%;
}

.cursor-ring {
  width:14px;height:14px;
  border:2px solid #fff;
  border-radius:50%;
}
</style>
</head>

<body class="theme-dark">

<div id="toolbar">
  <div class="tool active" data-tool="brick">Brick</div>
  <div class="tool" data-tool="metal">Metal</div>
  <div class="tool" data-tool="wood">Wood</div>
  <div class="tool" data-tool="stone">Stone</div>
  <div class="tool" data-tool="glass">Glass</div>
  <div class="tool" data-tool="sand">Sand</div>
  <div class="tool" data-tool="water">Water</div>
  <div class="tool" data-tool="oil">Oil</div>
  <div class="tool" data-tool="lava">Lava</div>
  <div class="tool" data-tool="fire">Fire</div>
  <div class="tool" data-tool="eraser">Eraser</div>
  <div class="tool" id="clear">Clear</div>
  <div class="tool" id="settingsBtn">Settings</div>
</div>

<div id="settings">
  <h3>Map Style</h3>
  <select id="themeSelect">
    <option value="theme-dark">Dark</option>
    <option value="theme-grid">Grid</option>
    <option value="theme-sand">Sand</option>
    <option value="theme-lab">Lab</option>
  </select>

  <h3>Grid</h3>
  <div class="setting">
    <label><input type="checkbox" id="gridToggle" checked> Show Grid</label>
  </div>
  <div class="setting">
    <input type="range" id="gridSize" min="8" max="40" value="20">
  </div>

  <h3>Cursor</h3>
  <select id="cursorSelect">
    <option value="cross">Cross</option>
    <option value="square">Square</option>
    <option value="dot">Dot</option>
    <option value="ring">Ring</option>
  </select>

  <h3>Sound</h3>
  <input type="range" id="volume" min="0" max="1" step="0.01" value="0.4">
</div>

<canvas id="canvas"></canvas>
<div id="cursor" class="cursor-cross"></div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const cursor = document.getElementById("cursor");

canvas.width=innerWidth;
canvas.height=innerHeight;
window.addEventListener("resize",()=>{
  canvas.width=innerWidth;
  canvas.height=innerHeight;
});

/* SETTINGS */
let gridOn=true;
let gridSize=20;
let volume=0.4;

document.getElementById("settingsBtn").onclick=()=>{
  settings.style.display=settings.style.display==="block"?"none":"block";
};
themeSelect.onchange=e=>document.body.className=e.target.value;
gridToggle.onchange=e=>gridOn=e.target.checked;
gridSize.oninput=e=>gridSize=+e.target.value;
volume.oninput=e=>volume=+e.target.value;

/* CURSOR */
cursorSelect.onchange=e=>{
  cursor.className="";
  cursor.classList.add("cursor-"+e.target.value);
};

/* INPUT */
let tool="brick", holding=false;
document.querySelectorAll(".tool").forEach(t=>{
  t.onclick=()=>{
    if(t.id==="clear"){objects=[];particles=[];return;}
    if(t.id==="settingsBtn")return;
    document.querySelectorAll(".tool").forEach(x=>x.classList.remove("active"));
    t.classList.add("active");
    tool=t.dataset.tool;
  };
});

document.addEventListener("mousemove",e=>{
  cursor.style.left=e.clientX+"px";
  cursor.style.top=e.clientY+"px";
});

canvas.onmousedown=()=>holding=true;
canvas.onmouseup=()=>holding=false;

/* WORLD */
const gravity=0.35;
let objects=[], particles=[];

/* GRID SNAP */
function snap(v){ return Math.floor(v/gridSize)*gridSize; }

/* OBJECT */
class Obj{
  constructor(x,y,w,h,type){
    this.x=x;this.y=y;this.w=w;this.h=h;
    this.type=type;
    this.burn=0;
    this.dead=false;
  }
  update(){
    if(!["brick","metal","stone"].includes(this.type)){
      this.y+=gravity;
    }
    this.x=Math.max(0,Math.min(canvas.width-this.w,this.x));
    this.y=Math.max(70,Math.min(canvas.height-this.h,this.y));

    if(this.burn>0 && !["metal","stone"].includes(this.type)){
      this.burn--;
      if(this.burn<=0) this.dead=true;
    }
  }
  draw(){
    ctx.fillStyle={
      brick:"#8d6e63",
      metal:"#9e9e9e",
      wood:"#a97142",
      stone:"#616161",
      glass:"rgba(180,220,255,.6)"
    }[this.type];
    ctx.fillRect(this.x,this.y,this.w,this.h);
  }
}

/* PARTICLE */
class Particle{
  constructor(x,y,type){
    this.x=x;this.y=y;
    this.vx=(Math.random()-0.5)*0.6;
    this.vy=0;
    this.type=type;
    this.life=200;
  }
  update(){
    if(["sand","lava","oil"].includes(this.type)) this.vy+=0.3;
    if(this.type==="water") this.vy+=0.15;
    if(this.type==="fire"){
      this.vy-=0.15;
      objects.forEach(o=>{
        if(o.type!=="metal" && o.type!=="stone" &&
           this.x>o.x&&this.x<o.x+o.w&&this.y>o.y&&this.y<o.y+o.h){
          o.burn=100;
        }
      });
    }

    this.x+=this.vx;
    this.y+=this.vy;

    this.x=Math.max(0,Math.min(canvas.width,this.x));
    this.y=Math.max(70,Math.min(canvas.height,this.y));
    this.life--;
  }
  draw(){
    ctx.fillStyle={
      sand:"#fbc02d",
      water:"#2196f3",
      lava:"#ff5722",
      fire:"#ff9800",
      oil:"#3e2723"
    }[this.type];
    ctx.fillRect(this.x,this.y,2,2);
  }
}

/* DRAW */
canvas.addEventListener("mousemove",e=>{
  if(!holding)return;
  let x=e.clientX,y=e.clientY;
  if(gridOn){ x=snap(x); y=snap(y); }

  if(["brick","metal","wood","stone","glass"].includes(tool)){
    objects.push(new Obj(x,y,gridSize,gridSize,tool));
  }
  if(["sand","water","lava","fire","oil"].includes(tool)){
    for(let i=0;i<6;i++) particles.push(new Particle(x,y,tool));
  }
  if(tool==="eraser"){
    objects=objects.filter(o=>Math.hypot(o.x-x,o.y-y)>30);
    particles=particles.filter(p=>Math.hypot(p.x-x,p.y-y)>30);
  }
});

/* LOOP */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(gridOn){
    ctx.strokeStyle="rgba(255,255,255,.05)";
    for(let x=0;x<canvas.width;x+=gridSize){
      ctx.beginPath();ctx.moveTo(x,70);ctx.lineTo(x,canvas.height);ctx.stroke();
    }
    for(let y=70;y<canvas.height;y+=gridSize){
      ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(canvas.width,y);ctx.stroke();
    }
  }

  objects.forEach(o=>o.update());
  particles.forEach(p=>p.update());

  objects=objects.filter(o=>!o.dead);
  particles=particles.filter(p=>p.life>0);

  objects.forEach(o=>o.draw());
  particles.forEach(p=>p.draw());

  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
